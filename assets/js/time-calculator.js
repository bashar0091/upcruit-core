var database = {
	"group":{
            "IT": {
                "Software Engineer": {
                    "West Sussex":"902",
                    "East Sussex":"43",
                    "Kent":"42",
                    "Surrey":"35",
                    "Greater London":"40",
                    "Essex":"38",
                    "Herts":"36",
                    "Bucks":"35",
                    "Berkshire":"23",
                    "Hamshire":"21",
                    },
                "Frontend Developer": {
                    "West Sussex":"1702",
                    "East Sussex":"1345",
                    "Kent":"1294",
                    "Surrey":"1089",
                    "Greater London":"1242",
                    "Essex":"1174",
                    "Herts":"1123",
                    "Bucks":"1089",
                    "Berkshire":"698",
                    "Hamshire":"664",
                    },
                "Backend Developer": {
                    "West Sussex":"302",
                    "East Sussex":"239",
                    "Kent":"230",
                    "Surrey":"193",
                    "Greater London":"220",
                    "Essex":"208",
                    "Herts":"199",
                    "Bucks":"193",
                    "Berkshire":"124",
                    "Hamshire":"118",
                    },
                "Full Stack Developer": {
                    "West Sussex":"55",
                    "East Sussex":"43",
                    "Kent":"42",
                    "Surrey":"35",
                    "Greater London":"40",
                    "Essex":"38",
                    "Herts":"36",
                    "Bucks":"35",
                    "Berkshire":"23",
                    "Hamshire":"21",
                    },
                "Application Support Engineer": {
                    "West Sussex":"101",
                    "East Sussex":"80",
                    "Kent":"77",
                    "Surrey":"65",
                    "Greater London":"74",
                    "Essex":"70",
                    "Herts":"67",
                    "Bucks":"65",
                    "Berkshire":"41",
                    "Hamshire":"39",
                    },
                "IT Support Engineer": {
                    "West Sussex":"435",
                    "East Sussex":"53",
                    "Kent":"35",
                    "Surrey":"24",
                    "Greater London":"46",
                    "Essex":"74",
                    "Herts":"34",
                    "Bucks":"45",
                    "Berkshire":"34",
                    "Hamshire":"75",
                    },
                "Software Tester": {
                    "West Sussex":"42",
                    "East Sussex":"33",
                    "Kent":"32",
                    "Surrey":"27",
                    "Greater London":"31",
                    "Essex":"29",
                    "Herts":"28",
                    "Bucks":"27",
                    "Berkshire":"17",
                    "Hamshire":"16",
                    },
                "QA Engineer": {
                    "West Sussex":"343",
                    "East Sussex":"464",
                    "Kent":"46",
                    "Surrey":"34",
                    "Greater London":"34",
                    "Essex":"644",
                    "Herts":"46",
                    "Bucks":"45",
                    "Berkshire":"34",
                    "Hamshire":"164",
                    },
                "Web Developer": {
                    "West Sussex":"33",
                    "East Sussex":"26",
                    "Kent":"25",
                    "Surrey":"21",
                    "Greater London":"24",
                    "Essex":"23",
                    "Herts":"22",
                    "Bucks":"21",
                    "Berkshire":"14",
                    "Hamshire":"13",
                    },
                "Solution Architect": {
                    "West Sussex":"23",
                    "East Sussex":"42",
                    "Kent":"53",
                    "Surrey":"63",
                    "Greater London":"354",
                    "Essex":"64",
                    "Herts":"34",
                    "Bucks":"23",
                    "Berkshire":"35",
                    "Hamshire":"634",
                    },
                "Technical Architect": {
                    "West Sussex":"78",
                    "East Sussex":"48",
                    "Kent":"467",
                    "Surrey":"83",
                    "Greater London":"34",
                    "Essex":"32",
                    "Herts":"65",
                    "Bucks":"86",
                    "Berkshire":"95",
                    "Hamshire":"83",
                    },
                "Microsoft Tech Engineer": {
                    "West Sussex":"57",
                    "East Sussex":"434",
                    "Kent":"345",
                    "Surrey":"23",
                    "Greater London":"21",
                    "Essex":"67",
                    "Herts":"86",
                    "Bucks":"14",
                    "Berkshire":"894",
                    "Hamshire":"833",
                    },
            },
			"Sales": {
				"Account Manager": {
					"West Sussex":"302",
					"East Sussex":"239",
					"Kent":"230",
					"Surrey":"193",
					"Greater London":"220",
					"Essex":"208",
					"Herts":"199",
					"Bucks":"193",
					"Berkshire":"124",
					"Hamshire":"118",
					},
				"New Business Development Manager": {
					"West Sussex":"266",
					"East Sussex":"210",
					"Kent":"202",
					"Surrey":"170",
					"Greater London":"194",
					"Essex":"184",
					"Herts":"176",
					"Bucks":"170",
					"Berkshire":"109",
					"Hamshire":"104",
					},
				"Customer Service Assistant": {
					"West Sussex":"847",
					"East Sussex":"669",
					"Kent":"644",
					"Surrey":"542",
					"Greater London":"618",
					"Essex":"584",
					"Herts":"559",
					"Bucks":"542",
					"Berkshire":"347",
					"Berkshire":"330",
                    "Hamshire":"33",
					},
				"Field Sales Executive": {
					"West Sussex":"208",
					"East Sussex":"164",
					"Kent":"158",
					"Surrey":"133",
					"Greater London":"152",
					"Essex":"144",
					"Herts":"137",
					"Bucks":"133",
					"Berkshire":"85",
					"Hamshire":"81",
					},
				"Sales Executive": {
					"West Sussex":"297",
					"East Sussex":"235",
					"Kent":"226",
					"Surrey":"190",
					"Greater London":"217",
					"Essex":"205",
					"Herts":"196",
					"Bucks":"190",
					"Berkshire":"122",
					"Hamshire":"116",
					},
				"Telesales Executive": {
					"West Sussex":"111",
					"East Sussex":"88",
					"Kent":"84",
					"Surrey":"71",
					"Greater London":"81",
					"Essex":"77",
					"Herts":"73",
					"Bucks":"71",
					"Berkshire":"46",
					"Hamshire":"43",
					}
			},
			"Marketing": {
				"Advertising Executive": {
					"West Sussex":"97",
					"East Sussex":"77",
					"Kent":"74",
					"Surrey":"62",
					"Greater London":"71",
					"Essex":"67",
					"Herts":"64",
					"Bucks":"62",
					"Berkshire":"40",
					"Hamshire":"38",
					},
				"Campaign Manager": {
					"West Sussex":"92",
					"East Sussex":"73",
					"Kent":"70",
					"Surrey":"59",
					"Greater London":"67",
					"Essex":"63",
					"Herts":"61",
					"Bucks":"59",
					"Berkshire":"38",
					"Hamshire":"36",
					},
				"Commercial Manager": {
					"West Sussex":"153",
					"East Sussex":"121",
					"Kent":"116",
					"Surrey":"98",
					"Greater London":"112",
					"Essex":"106",
					"Herts":"101",
					"Bucks":"98",
					"Berkshire":"63",
					"Hamshire":"60",
					},
				"Digital Marketing Executive": {
					"West Sussex":"93",
					"East Sussex":"73",
					"Kent":"71",
					"Surrey":"60",
					"Greater London":"68",
					"Essex":"64",
					"Herts":"61",
					"Bucks":"60",
					"Berkshire":"38",
					"Hamshire":"36",
					},
				"Editor": {
					"West Sussex":"49",
					"East Sussex":"39",
					"Kent":"37",
					"Surrey":"31",
					"Greater London":"36",
					"Essex":"34",
					"Herts":"32",
					"Bucks":"31",
					"Berkshire":"20",
					"Hamshire":"19",
					},
				"Editorial Assistant": {
					"West Sussex":"106",
					"East Sussex":"84",
					"Kent":"81",
					"Surrey":"68",
					"Greater London":"77",
					"Essex":"73",
					"Herts":"70",
					"Bucks":"68",
					"Berkshire":"43",
					"Hamshire":"41",
					},
				"Marketing Manager": {
					"West Sussex":"120",
					"East Sussex":"95",
					"Kent":"91",
					"Surrey":"77",
					"Greater London":"88",
					"Essex":"83",
					"Herts":"79",
					"Bucks":"77",
					"Berkshire":"49",
					"Hamshire":"47",
					},
				"PR Assistant": {
					"West Sussex":"229",
					"East Sussex":"181",
					"Kent":"174",
					"Surrey":"147",
					"Greater London":"167",
					"Essex":"158",
					"Herts":"151",
					"Bucks":"147",
					"Berkshire":"94",
					"Hamshire":"89",
					},
				"PR Manager": {
					"West Sussex":"114",
					"East Sussex":"90",
					"Kent":"87",
					"Surrey":"73",
					"Greater London":"83",
					"Essex":"79",
					"Herts":"75",
					"Bucks":"73",
					"Berkshire":"47",
					"Hamshire":"44",
					},
				"Publishing Director": {
					"West Sussex":"53",
					"East Sussex":"42",
					"Kent":"40",
					"Surrey":"34",
					"Greater London":"39",
					"Essex":"37",
					"Herts":"35",
					"Bucks":"34",
					"Berkshire":"22",
					"Hamshire":"21",
					},
				"Social Medial Expert": {
					"West Sussex":"45",
					"East Sussex":"34",
					"Kent":"56",
					"Surrey":"63",
					"Greater London":"24",
					"Essex":"75",
					"Herts":"34",
					"Bucks":"26",
					"Berkshire":"23",
					"Hamshire":"74",
					},
			},
			"HR":{
				"Head of Recruitment": {
					"West Sussex":"71",
					"East Sussex":"56",
					"Kent":"54",
					"Surrey":"45",
					"Greater London":"52",
					"Essex":"49",
					"Herts":"47",
					"Bucks":"45",
					"Berkshire":"29",
					"Hamshire":"28",
					},
				"HR Administrator": {
					"West Sussex":"254",
					"East Sussex":"201",
					"Kent":"193",
					"Surrey":"163",
					"Greater London":"185",
					"Essex":"175",
					"Herts":"168",
					"Bucks":"163",
					"Berkshire":"104",
					"Hamshire":"99",
					},
				"HR Advisor": {
					"West Sussex":"178",
					"East Sussex":"141",
					"Kent":"135",
					"Surrey":"114",
					"Greater London":"130",
					"Essex":"123",
					"Herts":"117",
					"Bucks":"114",
					"Berkshire":"73",
					"Hamshire":"69",
					},
				"HR Assistant": {
					"West Sussex":"201",
					"East Sussex":"159",
					"Kent":"153",
					"Surrey":"129",
					"Greater London":"147",
					"Essex":"139",
					"Herts":"133",
					"Bucks":"129",
					"Berkshire":"82",
					"Hamshire":"78",
					},
				"HR Business Partner": {
					"West Sussex":"105",
					"East Sussex":"83",
					"Kent":"80",
					"Surrey":"67",
					"Greater London":"77",
					"Essex":"72",
					"Herts":"69",
					"Bucks":"67",
					"Berkshire":"43",
					"Hamshire":"41",
					},
				"HR Manager": {
					"West Sussex":"84",
					"East Sussex":"66",
					"Kent":"64",
					"Surrey":"54",
					"Greater London":"61",
					"Essex":"58",
					"Herts":"55",
					"Bucks":"54",
					"Berkshire":"34",
					"Hamshire":"33",
					},
				"Talent Aqucition Specialist": {
					"West Sussex":"64",
					"East Sussex":"68",
					"Kent":"780",
					"Surrey":"789",
					"Greater London":"67",
					"Essex":"345",
					"Herts":"346",
					"Bucks":"867",
					"Berkshire":"79",
					"Hamshire":"68",
					},
				"Sourcing Specialist": {
					"West Sussex":"97",
					"East Sussex":"23",
					"Kent":"12",
					"Surrey":"46",
					"Greater London":"56",
					"Essex":"89",
					"Herts":"55",
					"Bucks":"43",
					"Berkshire":"86",
					"Hamshire":"34",
					},
				"CIPD Personnel Officer ": {
					"West Sussex":"54",
					"East Sussex":"23",
					"Kent":"56",
					"Surrey":"74",
					"Greater London":"74",
					"Essex":"53",
					"Herts":"32",
					"Bucks":"34",
					"Berkshire":"64",
					"Hamshire":"55",
					},
			},
			"Administration": {
				"Office Administrator": {
					"West Sussex":"1675",
					"East Sussex":"1323",
					"Kent":"1273",
					"Surrey":"1072",
					"Greater London":"1223",
					"Essex":"1156",
					"Herts":"1106",
					"Bucks":"1072",
					"Berkshire":"687",
					"Hamshire":"653",
					},
				"Facilities Manager": {
					"West Sussex":"131",
					"East Sussex":"103",
					"Kent":"100",
					"Surrey":"84",
					"Greater London":"96",
					"Essex":"90",
					"Herts":"86",
					"Bucks":"84",
					"Berkshire":"54",
					"Hamshire":"51",
					},
				"Operation Manager": {
					"West Sussex":"302",
					"East Sussex":"239",
					"Kent":"230",
					"Surrey":"193",
					"Greater London":"220",
					"Essex":"208",
					"Herts":"199",
					"Bucks":"193",
					"Berkshire":"124",
					"Hamshire":"118",
					},
				"Office Assistant": {
					"West Sussex":"1830",
					"East Sussex":"1446",
					"Kent":"1391",
					"Surrey":"1171",
					"Greater London":"1336",
					"Essex":"1263",
					"Bucks":"1208",
					"Berkshire":"1171",
					"Hamshire":"750",
					},
				"Personal Assistant": {
					"West Sussex":"831",
					"East Sussex":"656",
					"Kent":"632",
					"Surrey":"532",
					"Greater London":"607",
					"Essex":"573",
					"Herts":"548",
					"Bucks":"532",
					"Berkshire":"341",
					"Hamshire":"324",
					},
				"Receptionist": {
					"West Sussex":"1732",
					"East Sussex":"1368",
					"Kent":"1316",
					"Surrey":"1108",
					"Greater London":"1264",
					"Essex":"1195",
					"Herts":"1143",
					"Bucks":"1108",
					"Berkshire":"710",
					"Hamshire":"675",
					},
				"Virtual Assistant": {
					"West Sussex":"761",
					"East Sussex":"601",
					"Kent":"578",
					"Surrey":"487",
					"Greater London":"556",
					"Essex":"525",
					"Herts":"502",
					"Bucks":"487",
					"Berkshire":"312",
					"Hamshire":"297",
					},
			},
			"Retail": {
				"Team Leader": {
					"West Sussex":"151",
					"East Sussex":"119",
					"Kent":"115",
					"Surrey":"97",
					"Greater London":"110",
					"Essex":"104",
					"Herts":"100",
					"Bucks":"97",
					"Berkshire":"62",
					"Hamshire":"59",
					},
				"Store Assistant": {
					"West Sussex":"403",
					"East Sussex":"318",
					"Kent":"306",
					"Surrey":"258",
					"Greater London":"294",
					"Essex":"278",
					"Herts":"266",
					"Bucks":"258",
					"Berkshire":"165",
					"Hamshire":"157",
					},
				"Store Manager": {
					"West Sussex":"209",
					"East Sussex":"165",
					"Kent":"159",
					"Surrey":"134",
					"Greater London":"153",
					"Essex":"144",
					"Herts":"138",
					"Bucks":"134",
					"Berkshire":"86",
					"Hamshire":"82",
					},
				"Retail Supervisor": {
					"West Sussex":"432",
					"East Sussex":"23",
					"Kent":"25",
					"Surrey":"52",
					"Greater London":"63",
					"Essex":"36",
					"Herts":"73",
					"Bucks":"85",
					"Berkshire":"83",
					"Hamshire":"93",
					},
			},
			"Healthcare": {
				"Care Worker": {
					"West Sussex":"63",
					"East Sussex":"34",
					"Kent":"63",
					"Surrey":"75",
					"Greater London":"85",
					"Essex":"85",
					"Herts":"23",
					"Bucks":"33",
					"Berkshire":"35",
					"Hamshire":"26",
					},
				"Care Assistant - Bank": {
					"West Sussex":"74",
					"East Sussex":"224",
					"Kent":"26",
					"Surrey":"26",
					"Greater London":"58",
					"Essex":"85",
					"Herts":"354",
					"Bucks":"46",
					"Berkshire":"85",
					"Hamshire":"75",
					},
				"Care Home Manager": {
					"West Sussex":"96",
					"East Sussex":"342",
					"Kent":"46",
					"Surrey":"73",
					"Greater London":"85",
					"Essex":"37",
					"Herts":"64",
					"Bucks":"32",
					"Berkshire":"63",
					"Hamshire":"74",
					},
				"Socialcare Worker": {
					"West Sussex":"84",
					"East Sussex":"24",
					"Kent":"53",
					"Surrey":"73",
					"Greater London":"77",
					"Essex":"78",
					"Herts":"83",
					"Bucks":"85",
					"Berkshire":"24",
					"Hamshire":"89",
					},
				"Domestic Care Assistant": {
					"West Sussex":"83",
					"East Sussex":"84",
					"Kent":"13",
					"Surrey":"52",
					"Greater London":"63",
					"Essex":"36",
					"Herts":"73",
					"Bucks":"96",
					"Berkshire":"85",
					"Hamshire":"23",
					},
			},
	}
}


var groups = database.group;
var jobTypeoutput = "";
var jobType = jQuery("#jobType");
var jobName = jQuery("#jobName");
var jobLocated = jQuery("#jobLocated");
var applicationNumber = jQuery("#applicationNumber");
var eachCv = jQuery("#eachCv");
var timeSaved = jQuery("#timeSaved");

// generate the initial job type select element
jobTypeoutput += "<select class='form-select py-3 rounded-0 focus-0'>";
for (var jobTitle in groups) {
    jobTypeoutput += `<option value="${jobTitle}">` + jobTitle + "</option>";
}
jobTypeoutput += "</select>";
jQuery(jobType).html(jobTypeoutput);

function jobNameFunc(jobN) {
    var jobNameoutput = "<select class='form-select py-3 rounded-0 focus-0'>";
    for (var job in groups[jobN]) {
        jobNameoutput += "<option>" + job + "</option>";
    }
    jobNameoutput += "</select>";
    return jobNameoutput;
}

function jobLocatedFunc(jobN, jobL) {
    var jobLocatedoutput = "<select class='form-select py-3 rounded-0 focus-0'>";
    for (var city in groups[jobN][jobL]) {
        jobLocatedoutput += `<option value='${groups[jobN][jobL][city]}'>` + city + "</option>";
    }
    jobLocatedoutput += "</select>";
    return jobLocatedoutput;
}

var jobTypeVal = jobType.find('select:first-child').val();
var jobNameoutput = jobNameFunc(jobTypeVal);
jQuery(jobName).html(jobNameoutput);

var jobLocateVal = jobName.find('select:first-child').val();
var jobLocatedoutput = jobLocatedFunc(jobTypeVal, jobLocateVal);
jQuery(jobLocated).html(jobLocatedoutput);

jQuery(jobType).on('change', 'select', function() {
    var jobTypeVal = jQuery(this).val();
    var jobNameoutput = jobNameFunc(jobTypeVal);

    jQuery(jobName).html(jobNameoutput);
    var jobLocatedoutput = jobLocatedFunc(jobTypeVal, jobName.find('select option:first-child').text());
    jQuery(jobLocated).html(jobLocatedoutput);

    jQuery(applicationNumber).html(jobLocated.find('select option:first-child').val());
});

jQuery(jobName).on('change', 'select', function() {
    var jobTypeVal = jQuery(jobType).find('select').val();
    var jobNameVal = jQuery(this).val();

    var jobLocatedoutput = jobLocatedFunc(jobTypeVal, jobNameVal);
    jQuery(jobLocated).html(jobLocatedoutput);

    jQuery(applicationNumber).html(jobLocated.find('select option:first-child').val());
});

jQuery(jobLocated).on('change', 'select', function() {
    var jobLocateVal = jQuery(this).val();
    jQuery(applicationNumber).html(jobLocateVal);
});

var jobLocatedFirst = jobLocated.find('select:first-child').val();
var eachCvFirst = eachCv.find('select:first-child').val();

jQuery(applicationNumber).html(jobLocatedFirst);

function timeCalc(appN, cvE) {
    var mins = (appN * cvE) / 60;
    var hours = '';
    if (mins > 60){
        hours = mins / 60;
        hours = Math.floor(hours);
        hoursMin = hours * 60;
        mins = mins - hoursMin;		
    } else {
        mins = mins;
    }
    return { mins: mins, hours: hours };
}

var time = timeCalc(jobLocatedFirst, eachCvFirst);
jQuery(timeSaved).html(`${time.hours} hours, ${time.mins} mins`);

jQuery(eachCv).on('change', 'select', function() {
    var eachCvVal = jQuery(this).val(); 
    var applicationNumberVal = applicationNumber.text();

    var time = timeCalc(eachCvVal, applicationNumberVal);

    if(time.hours == '') {
        jQuery(timeSaved).html(`${time.mins} mins`);
    } else {
        jQuery(timeSaved).html(`${time.hours} hours, ${time.mins} mins`);
    }
    
});
